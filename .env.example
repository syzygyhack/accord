# accord server configuration
# Copy to .env and edit: cp .env.example .env
#
# Values marked REQUIRED must be set before running.
# The server warns at startup if secrets are still default values.

# ==============================================================================
# REQUIRED — you must set these before running
# ==============================================================================

# Secret for signing JWT tokens (REQUIRED).
# Generate with: openssl rand -base64 32
JWT_SECRET=

# LiveKit API credentials (REQUIRED).
# Generate a key/secret pair.
LIVEKIT_API_KEY=
LIVEKIT_API_SECRET=

# MySQL root password (REQUIRED) — used for initial DB setup.
# Generate with: openssl rand -base64 32
MYSQL_ROOT_PASSWORD=

# Bearer token for Ergo HTTP API (REQUIRED).
# Used by accord-files; injected into Ergo config.
# Generate with: openssl rand -base64 32
ERGO_API_TOKEN=

# ==============================================================================
# LAN DEPLOYMENT (docker-compose.lan.yml only)
# ==============================================================================

# Your machine's LAN IP address. REQUIRED when using docker-compose.lan.yml.
# The LAN compose file derives all network URLs from this value.
# Not used by docker-compose.yml (dev mode).
#
# Find your LAN IP:
#   Windows:  ipconfig | findstr IPv4
#   Linux:    ip addr show | grep "inet "
#   macOS:    ipconfig getifaddr en0
#
# IMPORTANT: If your IP changes (DHCP), update this value and restart.
# For a stable setup, assign a static IP or set SERVER_ID below.
# LAN_IP=192.168.1.100
#
# Firewall: these ports must be open on the host for LAN clients:
#   TCP 443          — HTTPS (Caddy reverse proxy, all traffic)
#   TCP 80           — HTTP redirect to HTTPS
#   TCP 7881         — LiveKit media fallback (TCP)
#   UDP 50060-50160  — LiveKit media (WebRTC audio/video)

# ==============================================================================
# SERVER IDENTITY
# ==============================================================================

# Display name shown to clients
# SERVER_NAME=My Accord Server

# Stable server identifier used in JWTs and invite links (URL-safe).
# Typically your public hostname (without scheme).
# For LAN: set this to avoid JWT invalidation when LAN_IP changes (DHCP).
# SERVER_ID=chat.example.com

# MySQL password for the dedicated 'ergo' user (optional).
# Falls back to MYSQL_ROOT_PASSWORD if unset.
# For production, set a separate password: openssl rand -base64 32
# MYSQL_ERGO_PASSWORD=

# ==============================================================================
# ADMIN
# ==============================================================================

# Admin accounts — comma-separated list of Ergo account names.
# These accounts can access /api/admin/* endpoints (stats, users, kick/ban, audit log).
# ADMIN_ACCOUNTS=alice,bob

# ==============================================================================
# NETWORKING (advanced — most users don't need these)
# ==============================================================================
# For LAN deployment, just set LAN_IP above. These are only needed for
# custom setups (e.g. domain-based deployment, nginx, split-host).

# Caddy site address. LAN compose sets this to LAN_IP automatically (HTTPS).
# For domain-based deployment, set to your domain for Caddy auto-HTTPS.
# Dev compose defaults to :80 (plain HTTP).
# SITE_ADDRESS=:80

# Max upload size in bytes (default: 25 MB)
# MAX_FILE_SIZE=26214400

# ==============================================================================
# TUNING (defaults are sensible — only change if needed)
# ==============================================================================

# JWT lifetime in seconds (default: 3600 = 1 hour)
# JWT_EXPIRY=3600

# Ergo IRC server API (internal Docker address)
# ERGO_API=http://ergo:8089

# NOTE: If you change ERGO_API_TOKEN, restart containers so Ergo picks it up.

# Rate limits (requests per window). Defaults are reasonable for most deployments.
# RATE_LIMIT_AUTH_MAX=10
# RATE_LIMIT_AUTH_WINDOW=900000
# RATE_LIMIT_PREVIEW_MAX=30
# RATE_LIMIT_UPLOAD_MAX=20
# RATE_LIMIT_INVITE_MAX=10
# RATE_LIMIT_WINDOW=60000
